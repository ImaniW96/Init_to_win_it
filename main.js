!function(){"use strict";class t{constructor(t,e){this._data=t,this._cardSelector=e,this._email=t.email,this._location=t.location,this._desc=t.text,this._link=t.link,this._cardTemplate=e}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".donation-card").cloneNode(!0)}createCard(){return this._cardElement=this._getTemplate(),this._cardEmail=this._cardElement.querySelector(".donation-card__email"),this._cardLocation=this._cardElement.querySelector(".donation-card__location"),this._cardDonation=this._cardElement.querySelector(".donation-card__description"),this._cardImage=this._cardElement.querySelector(".donation-card__image"),this._cardEmail.textContent=`Email: ${this._email}`,this._cardLocation.textContent=`Location: ${this._location}`,this._cardDonation.textContent=`Donation: ${this._desc}`,this._cardImage.src=this._link,this._cardImage.alt=this._desc,this._cardElement}}class e{constructor(t,e){this._renderer=t,this._container=document.querySelector(e)}renderItems(t){t.forEach((t=>{this.addItem(t)}))}addItem(t){const e=this._renderer(t);this._container.prepend(e)}clearItems(){if(this._cards=this._container.querySelectorAll(".charity-card"),null!==this._cards)for(var t=0;t<this._cards.length;t++)this._cards[t].remove()}}class r{constructor(t,e){this._data=t,this._name=t.name,this._profileUrl=t.profileUrl,this._logoUrl=t.logoUrl,this._location=t.location,this._cardSelector=e}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".charity-card").cloneNode(!0)}generateCard(){return this._element=this._getTemplate(),this._element.querySelector(".charity-card__name").textContent=this._name,this._element.querySelector(".charity-card__location").textContent=this._location,this._element.querySelector(".charity-card__url").href=this._profileUrl,this._element}}class s{constructor(t){let{popupSelector:e}=t;this._popupElement=document.querySelector(e),this._popupCloseButton=this._popupElement.querySelector(".popup__close-button"),this._closeByEscape=t=>{"Escape"===t.key&&this.close()}}open(){this._popupElement.classList.add("donation__popup_opened"),document.addEventListener("keydown",this._closeByEscape)}close(){this._popupElement.classList.remove("donation__popup_opened"),document.removeEventListener("keydown",this._closeByEscape)}setEventListeners(){this._popupElement.addEventListener("click",(t=>{t.target!==this._popupCloseButton&&t.target!==this._popupElement||this.close()}))}}const o=document.querySelector(".donate__button"),i=document.querySelector(".charities__container"),n=new class{constructor(t){let{baseUrl:e,apiKey:r}=t;this._baseUrl=e,this._apiKey=r}_request(t){return fetch(t).then(this.renderResult)}renderResult(t){return t.ok?t.json():Promise.reject(`'Error:' ${t.status}`)}getInfo(t){return fetch(`${this._baseUrl}search/causes=${t}?apiKey=${this._apiKey}`).then(this.renderResult)}}({baseUrl:"https://partners.every.org/v0.2/",apiKey:"pk_live_51295acbffe33d27ac313b33feb97d63"});new class{constructor(t,e){this._formElement=document.querySelector(t),this._form=this._formElement.querySelector(".charities__form"),this._formBtn=this._formElement.querySelector(".charities__button"),this._input=this._formElement.querySelector(".charities__input"),this._handleFormSubmit=e}_getCause(){for(var t,e=document.getElementsByName("cause"),r=0;r<e.length;r++)e[r].checked&&(t=e[r].value);return t}setEventListeners(){this._formBtn.addEventListener("click",(t=>{t.preventDefault();const e=this._getCause();this._handleFormSubmit(e),this._form.reset()}))}}(".charities",(function(t){a.clearItems(),n.getInfo(t).then((t=>{a.renderItems(t.nonprofits),i.classList.add("charities__container_active")})).catch(console.error)})).setEventListeners();const a=new e((function(t){return new r(t,"#charity-card-template").generateCard()}),"#charities-container"),c=new class extends s{constructor(t,e){super({popupSelector:e}),this._donationForm=this._popupElement.querySelector(".donation-form"),this._formSubmit=t}_getInputValues(){const t={};return this._donationForm.querySelectorAll(".donation-form__input").forEach((e=>{t[e.name]=e.value})),t}close(){this._donationForm.reset(),super.close()}setEventListeners(){this._donationForm.addEventListener("submit",(t=>{t.preventDefault();const e=this._getInputValues();this._formSubmit(e),this.close()})),super.setEventListeners()}}((t=>{l.addItem(t)}),".donation__popup"),l=new e((e=>new t(e,"#donation-card__template").createCard()),".donations__gallery");c.setEventListeners(),o.addEventListener("click",(()=>{c.open(),h.resetValidation()}));const _=document.querySelector("#donation-form"),h=new class{constructor(t,e){this._formSelector=t.formSelector,this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._formElement=e}_showInputError(t,e){const r=document.querySelector(`#${t.id}-error`);t.classList.add(this._inputErrorClass),r.textContent=e,r.classList.add(this._errorClass)}_hideInputError(t){const e=document.querySelector(`#${t.id}-error`);t.classList.remove(this._inputErrorClass),e.classList.remove(this._errorClass),e.textContent=""}_checkInputValidity(t){t.validity.valid?this._hideInputError(t):this._showInputError(t,t.validationMessage)}_hasInvalidInput(){return this._inputList.some((t=>!t.validity.valid))}resetValidation(){this.toggleButtonState(),this._inputList.forEach((t=>{this._hideInputError(t)}))}toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}disableSubmitButton=()=>{const t=this._formElement.querySelector(this._submitButtonSelector);t.classList.add(this._inactiveButtonClass),t.disabled=!0};_setEventListeners(){this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._buttonElement=this._formElement.querySelector(this._submitButtonSelector),this.toggleButtonState(),this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._checkInputValidity(t),this.toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(t=>{t.preventDefault()})),this._setEventListeners()}}({formSelector:".donation-form",inputSelector:".donation-form__input",submitButtonSelector:".donation-form__submit-button",inactiveButtonClass:"donation-form__submit-button_disabled",inputErrorClass:"donation-form__input_type_error",errorClass:"donation-form__error_visible"},_);h.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEtBQUtnSixvQkFBb0JMLEdBQ3pCM0ksS0FBS3VKLG1CQUFtQixHQUN4QixHQUVOLENBRUFRLGdCQUFBQSxHQUNFL0osS0FBSzZGLGFBQWExQixpQkFBaUIsVUFBV04sSUFDNUNBLEVBQUkwQyxnQkFBZ0IsSUFFdEJ2RyxLQUFLNEosb0JBQ1AsR0x2RjBDLENBQzFDN0IsYUFBYyxpQkFDZEUsY0FBZSx3QkFDZkUscUJBQXNCLGdDQUN0QkUsb0JBQXFCLHdDQUNyQkUsZ0JBQWlCLGtDQUNqQkUsV0FBWSxnQ0M0RFpiLEdBRUZGLEVBQXNCcUMsa0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jb2RlX2phbS8uL3NyYy9jb21wb25lbnRzL0RvbmF0aW9uQ2FyZC5qcyIsIndlYnBhY2s6Ly9jb2RlX2phbS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vY29kZV9qYW0vLi9zcmMvY29tcG9uZW50cy9DaGFyaXR5Q2FyZC5qcyIsIndlYnBhY2s6Ly9jb2RlX2phbS8uL3NyYy9jb21wb25lbnRzL3BvcHVwLmpzIiwid2VicGFjazovL2NvZGVfamFtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9jb2RlX2phbS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9jb2RlX2phbS8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9jb2RlX2phbS8uL3NyYy9jb21wb25lbnRzL0NoYXJpdGllcy5qcyIsIndlYnBhY2s6Ly9jb2RlX2phbS8uL3NyYy9jb21wb25lbnRzL0RvbmF0aW9uc1BvcHVwLmpzIiwid2VicGFjazovL2NvZGVfamFtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBEb25hdGlvbkNhcmQge1xyXG4gIGNvbnN0cnVjdG9yKGRhdGEsIGNhcmRUZW1wbGF0ZSkge1xyXG4gICAgdGhpcy5fZGF0YSA9IGRhdGE7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkVGVtcGxhdGU7XHJcbiAgICB0aGlzLl9lbWFpbCA9IGRhdGEuZW1haWw7XHJcbiAgICB0aGlzLl9sb2NhdGlvbiA9IGRhdGEubG9jYXRpb247XHJcbiAgICB0aGlzLl9kZXNjID0gZGF0YS50ZXh0O1xyXG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX2NhcmRUZW1wbGF0ZSA9IGNhcmRUZW1wbGF0ZTtcclxuICB9XHJcblxyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIGNvbnN0IF9jYXJkRWxlbWVudCA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5kb25hdGlvbi1jYXJkXCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gICAgcmV0dXJuIF9jYXJkRWxlbWVudDtcclxuICB9XHJcbiAgY3JlYXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuICAgIHRoaXMuX2NhcmRFbWFpbCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZG9uYXRpb24tY2FyZF9fZW1haWxcIik7XHJcbiAgICB0aGlzLl9jYXJkTG9jYXRpb24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5kb25hdGlvbi1jYXJkX19sb2NhdGlvblwiXHJcbiAgICApO1xyXG4gICAgdGhpcy5fY2FyZERvbmF0aW9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIuZG9uYXRpb24tY2FyZF9fZGVzY3JpcHRpb25cIlxyXG4gICAgKTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZG9uYXRpb24tY2FyZF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9jYXJkRW1haWwudGV4dENvbnRlbnQgPSBgRW1haWw6ICR7dGhpcy5fZW1haWx9YDtcclxuICAgIHRoaXMuX2NhcmRMb2NhdGlvbi50ZXh0Q29udGVudCA9IGBMb2NhdGlvbjogJHt0aGlzLl9sb2NhdGlvbn1gO1xyXG4gICAgdGhpcy5fY2FyZERvbmF0aW9uLnRleHRDb250ZW50ID0gYERvbmF0aW9uOiAke3RoaXMuX2Rlc2N9YDtcclxuXHJcbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl9kZXNjO1xyXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3RvcihyZW5kZXJlciwgZWxlbWVudFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlbGVtZW50U2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoaXRlbXMpIHtcclxuICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgdGhpcy5hZGRJdGVtKGl0ZW0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGl0ZW0pIHtcclxuICAgIGNvbnN0IG5ld0NhcmQgPSB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKG5ld0NhcmQpO1xyXG4gIH1cclxuXHJcbiAgY2xlYXJJdGVtcygpIHtcclxuICAgIHRoaXMuX2NhcmRzID0gdGhpcy5fY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY2hhcml0eS1jYXJkXCIpO1xyXG4gICAgaWYgKHRoaXMuX2NhcmRzICE9PSBudWxsKSB7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fY2FyZHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICB0aGlzLl9jYXJkc1tpXS5yZW1vdmUoKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDaGFyaXR5Q2FyZCB7XHJcbiAgY29uc3RydWN0b3IoZGF0YSwgY2FyZFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9kYXRhID0gZGF0YTtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9wcm9maWxlVXJsID0gZGF0YS5wcm9maWxlVXJsO1xyXG4gICAgdGhpcy5fbG9nb1VybCA9IGRhdGEubG9nb1VybDtcclxuICAgIHRoaXMuX2xvY2F0aW9uID0gZGF0YS5sb2NhdGlvbjtcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICB9XHJcblxyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIGNvbnN0IF9jYXJkRWxlbWVudCA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jaGFyaXR5LWNhcmRcIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcbiAgICByZXR1cm4gX2NhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcblxyXG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNoYXJpdHktY2FyZF9fbmFtZVwiKS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2hhcml0eS1jYXJkX19sb2NhdGlvblwiKS50ZXh0Q29udGVudCA9XHJcbiAgICAgIHRoaXMuX2xvY2F0aW9uO1xyXG4gICAgLy8gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNoYXJpdHktY2FyZF9fbG9nb1wiKS5zcmMgPSB0aGlzLl9sb2dvVXJsO1xyXG4gICAgLy8gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNoYXJpdHktY2FyZF9fbG9nb1wiKS5hbHQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNoYXJpdHktY2FyZF9fdXJsXCIpLmhyZWYgPSB0aGlzLl9wcm9maWxlVXJsO1xyXG5cclxuICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuX2VsZW1lbnQpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9wb3B1cENsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLnBvcHVwX19jbG9zZS1idXR0b25cIlxyXG4gICAgKTtcclxuICAgIHRoaXMuX2Nsb3NlQnlFc2NhcGUgPSAoZXZ0KSA9PiB7XHJcbiAgICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gIH1cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJkb25hdGlvbl9fcG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5fY2xvc2VCeUVzY2FwZSk7XHJcbiAgfVxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJkb25hdGlvbl9fcG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5fY2xvc2VCeUVzY2FwZSk7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBpZiAoXHJcbiAgICAgICAgZXZ0LnRhcmdldCA9PT0gdGhpcy5fcG9wdXBDbG9zZUJ1dHRvbiB8fFxyXG4gICAgICAgIGV2dC50YXJnZXQgPT09IHRoaXMuX3BvcHVwRWxlbWVudFxyXG4gICAgICApIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgY29uc3QgZG9uYXRpb25Gb3JtVmFsaWRhdGlvbkNvbmZpZyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLmRvbmF0aW9uLWZvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5kb25hdGlvbi1mb3JtX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5kb25hdGlvbi1mb3JtX19zdWJtaXQtYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJkb25hdGlvbi1mb3JtX19zdWJtaXQtYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcImRvbmF0aW9uLWZvcm1fX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcImRvbmF0aW9uLWZvcm1fX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBjaGFyaXRpZXNGb3JtVmFsaWRhdGlvbkNvbmZpZyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLmNoYXJpdGllc19fZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLmNoYXJpdGllc19faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIuY2hhcml0aWVzX19idXR0b25cIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwiY2hhcml0aWVzLWZvcm1fX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcImNoYXJpdGllcy1mb3JtX19lcnJvcl92aXNpYmxlXCIsXHJcbn07XHJcbiIsIi8vIElNUE9SVFNcclxuaW1wb3J0IERvbmF0aW9uQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9Eb25hdGlvbkNhcmQuanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5pbXBvcnQgQ2hhcml0aWVzIGZyb20gXCIuLi9jb21wb25lbnRzL0NoYXJpdGllcy5qc1wiO1xyXG5pbXBvcnQgQ2hhcml0eUNhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2hhcml0eUNhcmQuanNcIjtcclxuaW1wb3J0IERvbmF0aW9uc1BvcHVwIGZyb20gXCIuLi9jb21wb25lbnRzL0RvbmF0aW9uc1BvcHVwLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCB7IGRvbmF0aW9uRm9ybVZhbGlkYXRpb25Db25maWcgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcbmltcG9ydCBcIi4uL3BhZ2VzL2luZGV4LmNzc1wiO1xyXG5cclxuY29uc3QgZG9uYXRlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5kb25hdGVfX2J1dHRvblwiKTtcclxuY29uc3QgY2hhcml0aWVzQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jaGFyaXRpZXNfX2NvbnRhaW5lclwiKTtcclxuLy9BUEkgSU5TVEFOVElBVElPTlxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vcGFydG5lcnMuZXZlcnkub3JnL3YwLjIvXCIsXHJcbiAgYXBpS2V5OiBcInBrX2xpdmVfNTEyOTVhY2JmZmUzM2QyN2FjMzEzYjMzZmViOTdkNjNcIixcclxufSk7XHJcblxyXG4vL0NIQVJJVFkgRk9STVxyXG5jb25zdCBjaGFyaXR5Rm9ybSA9IG5ldyBDaGFyaXRpZXMoXCIuY2hhcml0aWVzXCIsIGhhbmRsZUNoYXJpdHlGb3JtU3VibWl0KTtcclxuY2hhcml0eUZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUNoYXJpdHlGb3JtU3VibWl0KGRhdGEpIHtcclxuICBjaGFyaXR5Q2FyZExpc3QuY2xlYXJJdGVtcygpO1xyXG4gIGFwaVxyXG4gICAgLmdldEluZm8oZGF0YSlcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgY2hhcml0eUNhcmRMaXN0LnJlbmRlckl0ZW1zKHJlcy5ub25wcm9maXRzKTtcclxuICAgICAgY2hhcml0aWVzQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJjaGFyaXRpZXNfX2NvbnRhaW5lcl9hY3RpdmVcIik7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVDaGFyaXR5Q2FyZChkYXRhKSB7XHJcbiAgY29uc3QgY2hhcml0eUNhcmQgPSBuZXcgQ2hhcml0eUNhcmQoZGF0YSwgXCIjY2hhcml0eS1jYXJkLXRlbXBsYXRlXCIpO1xyXG4gIHJldHVybiBjaGFyaXR5Q2FyZC5nZW5lcmF0ZUNhcmQoKTtcclxufVxyXG5cclxuY29uc3QgY2hhcml0eUNhcmRMaXN0ID0gbmV3IFNlY3Rpb24oY3JlYXRlQ2hhcml0eUNhcmQsIFwiI2NoYXJpdGllcy1jb250YWluZXJcIik7XHJcblxyXG4vLyBET05BVElPTkZPUk1cclxuY29uc3QgY3JlYXRlRG9uYXRpb25DYXJkID0gKGNhcmREYXRhKSA9PiB7XHJcbiAgY29uc3QgbmV3Q2FyZCA9IG5ldyBEb25hdGlvbkNhcmQoY2FyZERhdGEsIFwiI2RvbmF0aW9uLWNhcmRfX3RlbXBsYXRlXCIpO1xyXG4gIHJldHVybiBuZXdDYXJkLmNyZWF0ZUNhcmQoKTtcclxufTtcclxuY29uc3QgZG9uYXRpb25SZW5kZXJlciA9IChpbnB1dERhdGEpID0+IHtcclxuICBzZWN0aW9uRG9uYXRpb25zLmFkZEl0ZW0oaW5wdXREYXRhKTtcclxufTtcclxuY29uc3QgZG9uYXRpb25zUG9wdXAgPSBuZXcgRG9uYXRpb25zUG9wdXAoZG9uYXRpb25SZW5kZXJlciwgXCIuZG9uYXRpb25fX3BvcHVwXCIpO1xyXG5jb25zdCBzZWN0aW9uRG9uYXRpb25zID0gbmV3IFNlY3Rpb24oY3JlYXRlRG9uYXRpb25DYXJkLCBcIi5kb25hdGlvbnNfX2dhbGxlcnlcIik7XHJcblxyXG4vLyBDTEFTUyBNRVRIT0QgQ0FMTFNcclxuZG9uYXRpb25zUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8vIEVWRU5UIExJU1RFTkVSU1xyXG5kb25hdGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBkb25hdGlvbnNQb3B1cC5vcGVuKCk7XHJcbiAgZG9uYXRpb25Gb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59KTtcclxuXHJcbi8vRk9STSBWQUxJREFUSU9OXHJcbmNvbnN0IGRvbmF0aW9uRm9ybUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RvbmF0aW9uLWZvcm1cIik7XHJcblxyXG5jb25zdCBkb25hdGlvbkZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRpb24oXHJcbiAgZG9uYXRpb25Gb3JtVmFsaWRhdGlvbkNvbmZpZyxcclxuICBkb25hdGlvbkZvcm1FbGVtZW50XHJcbik7XHJcbmRvbmF0aW9uRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBhcGlLZXkgfSkge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICB0aGlzLl9hcGlLZXkgPSBhcGlLZXk7XHJcbiAgfVxyXG5cclxuICBfcmVxdWVzdCh1cmwpIHtcclxuICAgIHJldHVybiBmZXRjaCh1cmwpLnRoZW4odGhpcy5yZW5kZXJSZXN1bHQpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyUmVzdWx0KHJlcykge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgJ0Vycm9yOicgJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gICBnZXRJbmZvKGNpdHkpIHtcclxuICAvLyAgICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vYXBpL29yZ2FuaXphdGlvbnMvc2VhcmNoLzoke2NpdHl9YCwge1xyXG4gIC8vICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgLy8gICAgIH0pO1xyXG4gIC8vICAgfVxyXG5cclxuICBnZXRJbmZvKGNhdXNlKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goXHJcbiAgICAgIGAke3RoaXMuX2Jhc2VVcmx9c2VhcmNoL2NhdXNlcz0ke2NhdXNlfT9hcGlLZXk9JHt0aGlzLl9hcGlLZXl9YFxyXG4gICAgKS50aGVuKHRoaXMucmVuZGVyUmVzdWx0KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2hhcml0aWVzIHtcclxuICBjb25zdHJ1Y3Rvcihmb3JtRWxlbWVudCwgaGFuZGxlRm9ybVN1Ym1pdCkge1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGZvcm1FbGVtZW50KTtcclxuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNoYXJpdGllc19fZm9ybVwiKTtcclxuICAgIHRoaXMuX2Zvcm1CdG4gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNoYXJpdGllc19fYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5faW5wdXQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNoYXJpdGllc19faW5wdXRcIik7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICB9XHJcblxyXG4gIF9nZXRDYXVzZSgpIHtcclxuICAgIHZhciBlbGVtZW50cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlOYW1lKFwiY2F1c2VcIik7XHJcbiAgICB2YXIgY2F1c2U7XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGlmIChlbGVtZW50c1tpXS5jaGVja2VkKSB7XHJcbiAgICAgICAgY2F1c2UgPSBlbGVtZW50c1tpXS52YWx1ZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGNhdXNlO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9mb3JtQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBjb25zdCBzZWxlY3RlZENhdXNlID0gdGhpcy5fZ2V0Q2F1c2UoKTtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdChzZWxlY3RlZENhdXNlKTtcclxuICAgICAgdGhpcy5fZm9ybS5yZXNldCgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9wb3B1cC5qc1wiO1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEb25hdGlvbnNQb3B1cCBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihmb3JtU3VibWl0LCBwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XHJcbiAgICB0aGlzLl9kb25hdGlvbkZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5kb25hdGlvbi1mb3JtXCIpO1xyXG4gICAgdGhpcy5fZm9ybVN1Ym1pdCA9IGZvcm1TdWJtaXQ7XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xyXG4gICAgY29uc3QgaW5wdXRFbGVtZW50cyA9IHRoaXMuX2RvbmF0aW9uRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFxyXG4gICAgICBcIi5kb25hdGlvbi1mb3JtX19pbnB1dFwiXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XHJcbiAgfVxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fZG9uYXRpb25Gb3JtLnJlc2V0KCk7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gIH1cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2RvbmF0aW9uRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGNvbnN0IGlucHV0VmFsdWVzID0gdGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKTtcclxuICAgICAgdGhpcy5fZm9ybVN1Ym1pdChpbnB1dFZhbHVlcyk7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH0pO1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5fZm9ybVNlbGVjdG9yID0gc2V0dGluZ3MuZm9ybVNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpIHtcclxuICAgIGNvbnN0IF9lcnJvckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgX2Vycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICAgIF9lcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IF9lcnJvckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgX2Vycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gICAgX2Vycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZGlzYWJsZVN1Ym1pdEJ1dHRvbiA9ICgpID0+IHtcclxuICAgIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvclxyXG4gICAgKTtcclxuICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xyXG4gIH07XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcclxuICAgICk7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3JcclxuICAgICk7XHJcbiAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcblxyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiRG9uYXRpb25DYXJkIiwiY29uc3RydWN0b3IiLCJkYXRhIiwiY2FyZFRlbXBsYXRlIiwidGhpcyIsIl9kYXRhIiwiX2NhcmRTZWxlY3RvciIsIl9lbWFpbCIsImVtYWlsIiwiX2xvY2F0aW9uIiwibG9jYXRpb24iLCJfZGVzYyIsInRleHQiLCJfbGluayIsImxpbmsiLCJfY2FyZFRlbXBsYXRlIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsImNyZWF0ZUNhcmQiLCJfY2FyZEVsZW1lbnQiLCJfY2FyZEVtYWlsIiwiX2NhcmRMb2NhdGlvbiIsIl9jYXJkRG9uYXRpb24iLCJfY2FyZEltYWdlIiwidGV4dENvbnRlbnQiLCJzcmMiLCJhbHQiLCJTZWN0aW9uIiwicmVuZGVyZXIiLCJlbGVtZW50U2VsZWN0b3IiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtcyIsImZvckVhY2giLCJpdGVtIiwiYWRkSXRlbSIsIm5ld0NhcmQiLCJwcmVwZW5kIiwiY2xlYXJJdGVtcyIsIl9jYXJkcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpIiwibGVuZ3RoIiwicmVtb3ZlIiwiQ2hhcml0eUNhcmQiLCJjYXJkU2VsZWN0b3IiLCJfbmFtZSIsIm5hbWUiLCJfcHJvZmlsZVVybCIsInByb2ZpbGVVcmwiLCJfbG9nb1VybCIsImxvZ29VcmwiLCJnZW5lcmF0ZUNhcmQiLCJfZWxlbWVudCIsImhyZWYiLCJQb3B1cCIsIl9yZWYiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9wb3B1cENsb3NlQnV0dG9uIiwiX2Nsb3NlQnlFc2NhcGUiLCJldnQiLCJrZXkiLCJjbG9zZSIsIm9wZW4iLCJjbGFzc0xpc3QiLCJhZGQiLCJhZGRFdmVudExpc3RlbmVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiZG9uYXRlQnV0dG9uIiwiY2hhcml0aWVzQ29udGFpbmVyIiwiYXBpIiwiYmFzZVVybCIsImFwaUtleSIsIl9iYXNlVXJsIiwiX2FwaUtleSIsIl9yZXF1ZXN0IiwidXJsIiwiZmV0Y2giLCJ0aGVuIiwicmVuZGVyUmVzdWx0IiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldEluZm8iLCJjYXVzZSIsImZvcm1FbGVtZW50IiwiaGFuZGxlRm9ybVN1Ym1pdCIsIl9mb3JtRWxlbWVudCIsIl9mb3JtIiwiX2Zvcm1CdG4iLCJfaW5wdXQiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9nZXRDYXVzZSIsImVsZW1lbnRzIiwiZ2V0RWxlbWVudHNCeU5hbWUiLCJjaGVja2VkIiwidmFsdWUiLCJwcmV2ZW50RGVmYXVsdCIsInNlbGVjdGVkQ2F1c2UiLCJyZXNldCIsImNoYXJpdHlDYXJkTGlzdCIsIm5vbnByb2ZpdHMiLCJjYXRjaCIsImNvbnNvbGUiLCJlcnJvciIsImRvbmF0aW9uc1BvcHVwIiwiZm9ybVN1Ym1pdCIsInN1cGVyIiwiX2RvbmF0aW9uRm9ybSIsIl9mb3JtU3VibWl0IiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRWYWx1ZXMiLCJpbnB1dCIsImlucHV0RGF0YSIsInNlY3Rpb25Eb25hdGlvbnMiLCJjYXJkRGF0YSIsImRvbmF0aW9uRm9ybVZhbGlkYXRvciIsInJlc2V0VmFsaWRhdGlvbiIsImRvbmF0aW9uRm9ybUVsZW1lbnQiLCJzZXR0aW5ncyIsIl9mb3JtU2VsZWN0b3IiLCJmb3JtU2VsZWN0b3IiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2UiLCJfZXJyb3JFbGVtZW50IiwiaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9pbnB1dExpc3QiLCJzb21lIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJfYnV0dG9uRWxlbWVudCIsImRpc2FibGVkIiwiZGlzYWJsZVN1Ym1pdEJ1dHRvbiIsImJ1dHRvbkVsZW1lbnQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJBcnJheSIsImZyb20iLCJlbmFibGVWYWxpZGF0aW9uIl0sInNvdXJjZVJvb3QiOiIifQ==