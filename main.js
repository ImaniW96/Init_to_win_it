!function(){"use strict";class t{constructor(t,e){this._data=t,this._cardSelector=e,this._email=t.email,this._location=t.location,this._desc=t.text,this._link=t.link,this._cardTemplate=e}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".donation-card").cloneNode(!0)}createCard(){return this._cardElement=this._getTemplate(),this._cardEmail=this._cardElement.querySelector(".donation-card__email"),this._cardLocation=this._cardElement.querySelector(".donation-card__location"),this._cardDonation=this._cardElement.querySelector(".donation-card__description"),this._cardImage=this._cardElement.querySelector(".donation-card__image"),this._cardEmail.textContent=`Email: ${this._email}`,this._cardLocation.textContent=`Location: ${this._location}`,this._cardDonation.textContent=`Donation: ${this._desc}`,this._cardImage.src=this._link,this._cardImage.alt=this._desc,this._cardElement}}class e{constructor(t,e){this._renderer=t,this._container=document.querySelector(e)}renderItems(t){t.forEach((t=>{this.addItem(t)}))}addItem(t){const e=this._renderer(t);this._container.prepend(e)}clearItems(){if(this._cards=this._container.querySelectorAll(".charity-card"),null!==this._cards)for(var t=0;t<this._cards.length;t++)this._cards[t].remove()}}class r{constructor(t,e){this._data=t,this._name=t.name,this._profileUrl=t.profileUrl,this._logoUrl=t.logoUrl,this._location=t.location,this._cardSelector=e}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".charity-card").cloneNode(!0)}generateCard(){return this._element=this._getTemplate(),this._element.querySelector(".charity-card__name").textContent=this._name,this._element.querySelector(".charity-card__location").textContent=this._location,this._element.querySelector(".charity-card__url").href=this._profileUrl,this._element}}class s{constructor(t){let{popupSelector:e}=t;this._popupElement=document.querySelector(e),this._popupCloseButton=this._popupElement.querySelector(".popup__close-button"),this._closeByEscape=t=>{"Escape"===t.key&&this.close()}}open(){this._popupElement.classList.add("donation__popup_opened"),document.addEventListener("keydown",this._closeByEscape)}close(){this._popupElement.classList.remove("donation__popup_opened"),document.removeEventListener("keydown",this._closeByEscape)}setEventListeners(){this._popupElement.addEventListener("click",(t=>{t.target!==this._popupCloseButton&&t.target!==this._popupElement||this.close()}))}}const o=document.querySelector(".donate__button"),i=new class{constructor(t){let{baseUrl:e,apiKey:r}=t;this._baseUrl=e,this._apiKey=r}_request(t){return fetch(t).then(this.renderResult)}renderResult(t){return t.ok?t.json():Promise.reject(`'Error:' ${t.status}`)}getInfo(t){return fetch(`${this._baseUrl}search/causes=${t}?apiKey=${this._apiKey}`).then(this.renderResult)}}({baseUrl:"https://partners.every.org/v0.2/",apiKey:"pk_live_51295acbffe33d27ac313b33feb97d63"});new class{constructor(t,e){this._formElement=document.querySelector(t),this._form=this._formElement.querySelector(".charities__form"),this._formBtn=this._formElement.querySelector(".charities__button"),this._input=this._formElement.querySelector(".charities__input"),this._handleFormSubmit=e}_getCause(){for(var t,e=document.getElementsByName("cause"),r=0;r<e.length;r++)e[r].checked&&(t=e[r].value);return t}setEventListeners(){this._formBtn.addEventListener("click",(t=>{t.preventDefault();const e=this._getCause();this._handleFormSubmit(e),this._form.reset()}))}}(".charities",(function(t){n.clearItems(),i.getInfo(t).then((t=>{n.renderItems(t.nonprofits)})).catch(console.error)})).setEventListeners();const n=new e((function(t){return new r(t,"#charity-card-template").generateCard()}),"#charities-container"),a=new class extends s{constructor(t,e){super({popupSelector:e}),this._donationForm=this._popupElement.querySelector(".donation-form"),this._formSubmit=t}_getInputValues(){const t={};return this._donationForm.querySelectorAll(".donation-form__input").forEach((e=>{t[e.name]=e.value})),t}close(){this._donationForm.reset(),super.close()}setEventListeners(){this._donationForm.addEventListener("submit",(t=>{t.preventDefault();const e=this._getInputValues();this._formSubmit(e),this.close()})),super.setEventListeners()}}((t=>{c.addItem(t)}),".donation__popup"),c=new e((e=>new t(e,"#donation-card__template").createCard()),".donations__gallery");a.setEventListeners(),o.addEventListener("click",(()=>{a.open(),_.resetValidation()}));const l=document.querySelector("#donation-form"),_=new class{constructor(t,e){this._formSelector=t.formSelector,this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._formElement=e}_showInputError(t,e){const r=document.querySelector(`#${t.id}-error`);t.classList.add(this._inputErrorClass),r.textContent=e,r.classList.add(this._errorClass)}_hideInputError(t){const e=document.querySelector(`#${t.id}-error`);t.classList.remove(this._inputErrorClass),e.classList.remove(this._errorClass),e.textContent=""}_checkInputValidity(t){t.validity.valid?this._hideInputError(t):this._showInputError(t,t.validationMessage)}_hasInvalidInput(){return this._inputList.some((t=>!t.validity.valid))}resetValidation(){this.toggleButtonState(),this._inputList.forEach((t=>{this._hideInputError(t)}))}toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}disableSubmitButton=()=>{const t=this._formElement.querySelector(this._submitButtonSelector);t.classList.add(this._inactiveButtonClass),t.disabled=!0};_setEventListeners(){this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._buttonElement=this._formElement.querySelector(this._submitButtonSelector),this.toggleButtonState(),this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._checkInputValidity(t),this.toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(t=>{t.preventDefault()})),this._setEventListeners()}}({formSelector:".donation-form",inputSelector:".donation-form__input",submitButtonSelector:".donation-form__submit-button",inactiveButtonClass:"donation-form__submit-button_disabled",inputErrorClass:"donation-form__input_type_error",errorClass:"donation-form__error_visible"},l);_.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFBLEdBQ0U5SixLQUFLNEYsYUFBYXpCLGlCQUFpQixVQUFXTixJQUM1Q0EsRUFBSXlDLGdCQUFnQixJQUV0QnRHLEtBQUsySixvQkFDUCxHTHZGMEMsQ0FDMUM3QixhQUFjLGlCQUNkRSxjQUFlLHdCQUNmRSxxQkFBc0IsZ0NBQ3RCRSxvQkFBcUIsd0NBQ3JCRSxnQkFBaUIsa0NBQ2pCRSxXQUFZLGdDQzJEWmIsR0FFRkYsRUFBc0JxQyxrQiIsInNvdXJjZXMiOlsid2VicGFjazovL2NvZGVfamFtLy4vc3JjL2NvbXBvbmVudHMvRG9uYXRpb25DYXJkLmpzIiwid2VicGFjazovL2NvZGVfamFtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9jb2RlX2phbS8uL3NyYy9jb21wb25lbnRzL0NoYXJpdHlDYXJkLmpzIiwid2VicGFjazovL2NvZGVfamFtLy4vc3JjL2NvbXBvbmVudHMvcG9wdXAuanMiLCJ3ZWJwYWNrOi8vY29kZV9qYW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL2NvZGVfamFtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL2NvZGVfamFtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL2NvZGVfamFtLy4vc3JjL2NvbXBvbmVudHMvQ2hhcml0aWVzLmpzIiwid2VicGFjazovL2NvZGVfamFtLy4vc3JjL2NvbXBvbmVudHMvRG9uYXRpb25zUG9wdXAuanMiLCJ3ZWJwYWNrOi8vY29kZV9qYW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIERvbmF0aW9uQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoZGF0YSwgY2FyZFRlbXBsYXRlKSB7XHJcbiAgICB0aGlzLl9kYXRhID0gZGF0YTtcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRUZW1wbGF0ZTtcclxuICAgIHRoaXMuX2VtYWlsID0gZGF0YS5lbWFpbDtcclxuICAgIHRoaXMuX2xvY2F0aW9uID0gZGF0YS5sb2NhdGlvbjtcclxuICAgIHRoaXMuX2Rlc2MgPSBkYXRhLnRleHQ7XHJcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5fY2FyZFRlbXBsYXRlID0gY2FyZFRlbXBsYXRlO1xyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgY29uc3QgX2NhcmRFbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmRvbmF0aW9uLWNhcmRcIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcbiAgICByZXR1cm4gX2NhcmRFbGVtZW50O1xyXG4gIH1cclxuICBjcmVhdGVDYXJkKCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5fY2FyZEVtYWlsID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5kb25hdGlvbi1jYXJkX19lbWFpbFwiKTtcclxuICAgIHRoaXMuX2NhcmRMb2NhdGlvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLmRvbmF0aW9uLWNhcmRfX2xvY2F0aW9uXCJcclxuICAgICk7XHJcbiAgICB0aGlzLl9jYXJkRG9uYXRpb24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5kb25hdGlvbi1jYXJkX19kZXNjcmlwdGlvblwiXHJcbiAgICApO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5kb25hdGlvbi1jYXJkX19pbWFnZVwiKTtcclxuICAgIHRoaXMuX2NhcmRFbWFpbC50ZXh0Q29udGVudCA9IGBFbWFpbDogJHt0aGlzLl9lbWFpbH1gO1xyXG4gICAgdGhpcy5fY2FyZExvY2F0aW9uLnRleHRDb250ZW50ID0gYExvY2F0aW9uOiAke3RoaXMuX2xvY2F0aW9ufWA7XHJcbiAgICB0aGlzLl9jYXJkRG9uYXRpb24udGV4dENvbnRlbnQgPSBgRG9uYXRpb246ICR7dGhpcy5fZGVzY31gO1xyXG5cclxuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IHRoaXMuX2Rlc2M7XHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHJlbmRlcmVyLCBlbGVtZW50U2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGVsZW1lbnRTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICAvLyByZW5kZXJJdGVtcyhpdGVtcykge1xyXG4gIC8vICAgaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gIC8vICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAvLyAgIH0pO1xyXG4gIC8vIH1cclxuICAvLyBhZGRJdGVtKGl0ZW0pIHtcclxuICAvLyAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGl0ZW0pO1xyXG4gIC8vIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoaXRlbXMpIHtcclxuICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgdGhpcy5hZGRJdGVtKGl0ZW0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGl0ZW0pIHtcclxuICAgIGNvbnN0IG5ld0NhcmQgPSB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKG5ld0NhcmQpO1xyXG4gIH1cclxuXHJcbiAgY2xlYXJJdGVtcygpIHtcclxuICAgIHRoaXMuX2NhcmRzID0gdGhpcy5fY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY2hhcml0eS1jYXJkXCIpO1xyXG4gICAgaWYgKHRoaXMuX2NhcmRzICE9PSBudWxsKSB7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fY2FyZHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICB0aGlzLl9jYXJkc1tpXS5yZW1vdmUoKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDaGFyaXR5Q2FyZCB7XHJcbiAgY29uc3RydWN0b3IoZGF0YSwgY2FyZFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9kYXRhID0gZGF0YTtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9wcm9maWxlVXJsID0gZGF0YS5wcm9maWxlVXJsO1xyXG4gICAgdGhpcy5fbG9nb1VybCA9IGRhdGEubG9nb1VybDtcclxuICAgIHRoaXMuX2xvY2F0aW9uID0gZGF0YS5sb2NhdGlvbjtcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICB9XHJcblxyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIGNvbnN0IF9jYXJkRWxlbWVudCA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jaGFyaXR5LWNhcmRcIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcbiAgICByZXR1cm4gX2NhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcblxyXG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNoYXJpdHktY2FyZF9fbmFtZVwiKS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2hhcml0eS1jYXJkX19sb2NhdGlvblwiKS50ZXh0Q29udGVudCA9XHJcbiAgICAgIHRoaXMuX2xvY2F0aW9uO1xyXG4gICAgLy8gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNoYXJpdHktY2FyZF9fbG9nb1wiKS5zcmMgPSB0aGlzLl9sb2dvVXJsO1xyXG4gICAgLy8gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNoYXJpdHktY2FyZF9fbG9nb1wiKS5hbHQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNoYXJpdHktY2FyZF9fdXJsXCIpLmhyZWYgPSB0aGlzLl9wcm9maWxlVXJsO1xyXG5cclxuICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuX2VsZW1lbnQpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9wb3B1cENsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLnBvcHVwX19jbG9zZS1idXR0b25cIlxyXG4gICAgKTtcclxuICAgIHRoaXMuX2Nsb3NlQnlFc2NhcGUgPSAoZXZ0KSA9PiB7XHJcbiAgICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gIH1cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJkb25hdGlvbl9fcG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5fY2xvc2VCeUVzY2FwZSk7XHJcbiAgfVxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJkb25hdGlvbl9fcG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5fY2xvc2VCeUVzY2FwZSk7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBpZiAoXHJcbiAgICAgICAgZXZ0LnRhcmdldCA9PT0gdGhpcy5fcG9wdXBDbG9zZUJ1dHRvbiB8fFxyXG4gICAgICAgIGV2dC50YXJnZXQgPT09IHRoaXMuX3BvcHVwRWxlbWVudFxyXG4gICAgICApIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgY29uc3QgZG9uYXRpb25Gb3JtVmFsaWRhdGlvbkNvbmZpZyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLmRvbmF0aW9uLWZvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5kb25hdGlvbi1mb3JtX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5kb25hdGlvbi1mb3JtX19zdWJtaXQtYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJkb25hdGlvbi1mb3JtX19zdWJtaXQtYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcImRvbmF0aW9uLWZvcm1fX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcImRvbmF0aW9uLWZvcm1fX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBjaGFyaXRpZXNGb3JtVmFsaWRhdGlvbkNvbmZpZyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLmNoYXJpdGllc19fZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLmNoYXJpdGllc19faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIuY2hhcml0aWVzX19idXR0b25cIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwiY2hhcml0aWVzLWZvcm1fX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcImNoYXJpdGllcy1mb3JtX19lcnJvcl92aXNpYmxlXCIsXHJcbn07XHJcbiIsIi8vIElNUE9SVFNcclxuaW1wb3J0IERvbmF0aW9uQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9Eb25hdGlvbkNhcmQuanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5pbXBvcnQgQ2hhcml0aWVzIGZyb20gXCIuLi9jb21wb25lbnRzL0NoYXJpdGllcy5qc1wiO1xyXG5pbXBvcnQgQ2hhcml0eUNhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2hhcml0eUNhcmQuanNcIjtcclxuaW1wb3J0IERvbmF0aW9uc1BvcHVwIGZyb20gXCIuLi9jb21wb25lbnRzL0RvbmF0aW9uc1BvcHVwLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCB7IGRvbmF0aW9uRm9ybVZhbGlkYXRpb25Db25maWcgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcbmltcG9ydCBcIi4uL3BhZ2VzL2luZGV4LmNzc1wiO1xyXG5cclxuY29uc3QgZG9uYXRlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5kb25hdGVfX2J1dHRvblwiKTtcclxuXHJcbi8vQVBJIElOU1RBTlRJQVRJT05cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL3BhcnRuZXJzLmV2ZXJ5Lm9yZy92MC4yL1wiLFxyXG4gIGFwaUtleTogXCJwa19saXZlXzUxMjk1YWNiZmZlMzNkMjdhYzMxM2IzM2ZlYjk3ZDYzXCIsXHJcbn0pO1xyXG5cclxuLy9DSEFSSVRZIEZPUk1cclxuY29uc3QgY2hhcml0eUZvcm0gPSBuZXcgQ2hhcml0aWVzKFwiLmNoYXJpdGllc1wiLCBoYW5kbGVDaGFyaXR5Rm9ybVN1Ym1pdCk7XHJcbmNoYXJpdHlGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVDaGFyaXR5Rm9ybVN1Ym1pdChkYXRhKSB7XHJcbiAgY2hhcml0eUNhcmRMaXN0LmNsZWFySXRlbXMoKTtcclxuICBhcGlcclxuICAgIC5nZXRJbmZvKGRhdGEpXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGNoYXJpdHlDYXJkTGlzdC5yZW5kZXJJdGVtcyhyZXMubm9ucHJvZml0cyk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVDaGFyaXR5Q2FyZChkYXRhKSB7XHJcbiAgY29uc3QgY2hhcml0eUNhcmQgPSBuZXcgQ2hhcml0eUNhcmQoZGF0YSwgXCIjY2hhcml0eS1jYXJkLXRlbXBsYXRlXCIpO1xyXG4gIHJldHVybiBjaGFyaXR5Q2FyZC5nZW5lcmF0ZUNhcmQoKTtcclxufVxyXG5cclxuY29uc3QgY2hhcml0eUNhcmRMaXN0ID0gbmV3IFNlY3Rpb24oY3JlYXRlQ2hhcml0eUNhcmQsIFwiI2NoYXJpdGllcy1jb250YWluZXJcIik7XHJcblxyXG4vLyBET05BVElPTkZPUk1cclxuY29uc3QgY3JlYXRlRG9uYXRpb25DYXJkID0gKGNhcmREYXRhKSA9PiB7XHJcbiAgY29uc3QgbmV3Q2FyZCA9IG5ldyBEb25hdGlvbkNhcmQoY2FyZERhdGEsIFwiI2RvbmF0aW9uLWNhcmRfX3RlbXBsYXRlXCIpO1xyXG4gIHJldHVybiBuZXdDYXJkLmNyZWF0ZUNhcmQoKTtcclxufTtcclxuY29uc3QgZG9uYXRpb25SZW5kZXJlciA9IChpbnB1dERhdGEpID0+IHtcclxuICBzZWN0aW9uRG9uYXRpb25zLmFkZEl0ZW0oaW5wdXREYXRhKTtcclxufTtcclxuY29uc3QgZG9uYXRpb25zUG9wdXAgPSBuZXcgRG9uYXRpb25zUG9wdXAoZG9uYXRpb25SZW5kZXJlciwgXCIuZG9uYXRpb25fX3BvcHVwXCIpO1xyXG5jb25zdCBzZWN0aW9uRG9uYXRpb25zID0gbmV3IFNlY3Rpb24oY3JlYXRlRG9uYXRpb25DYXJkLCBcIi5kb25hdGlvbnNfX2dhbGxlcnlcIik7XHJcblxyXG4vLyBDTEFTUyBNRVRIT0QgQ0FMTFNcclxuZG9uYXRpb25zUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8vIEVWRU5UIExJU1RFTkVSU1xyXG5kb25hdGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBkb25hdGlvbnNQb3B1cC5vcGVuKCk7XHJcbiAgZG9uYXRpb25Gb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59KTtcclxuXHJcbi8vRk9STSBWQUxJREFUSU9OXHJcbmNvbnN0IGRvbmF0aW9uRm9ybUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RvbmF0aW9uLWZvcm1cIik7XHJcblxyXG5jb25zdCBkb25hdGlvbkZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRpb24oXHJcbiAgZG9uYXRpb25Gb3JtVmFsaWRhdGlvbkNvbmZpZyxcclxuICBkb25hdGlvbkZvcm1FbGVtZW50XHJcbik7XHJcbmRvbmF0aW9uRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBhcGlLZXkgfSkge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICB0aGlzLl9hcGlLZXkgPSBhcGlLZXk7XHJcbiAgfVxyXG5cclxuICBfcmVxdWVzdCh1cmwpIHtcclxuICAgIHJldHVybiBmZXRjaCh1cmwpLnRoZW4odGhpcy5yZW5kZXJSZXN1bHQpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyUmVzdWx0KHJlcykge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgJ0Vycm9yOicgJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gICBnZXRJbmZvKGNpdHkpIHtcclxuICAvLyAgICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vYXBpL29yZ2FuaXphdGlvbnMvc2VhcmNoLzoke2NpdHl9YCwge1xyXG4gIC8vICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgLy8gICAgIH0pO1xyXG4gIC8vICAgfVxyXG5cclxuICBnZXRJbmZvKGNhdXNlKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goXHJcbiAgICAgIGAke3RoaXMuX2Jhc2VVcmx9c2VhcmNoL2NhdXNlcz0ke2NhdXNlfT9hcGlLZXk9JHt0aGlzLl9hcGlLZXl9YFxyXG4gICAgKS50aGVuKHRoaXMucmVuZGVyUmVzdWx0KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2hhcml0aWVzIHtcclxuICBjb25zdHJ1Y3Rvcihmb3JtRWxlbWVudCwgaGFuZGxlRm9ybVN1Ym1pdCkge1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGZvcm1FbGVtZW50KTtcclxuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNoYXJpdGllc19fZm9ybVwiKTtcclxuICAgIHRoaXMuX2Zvcm1CdG4gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNoYXJpdGllc19fYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5faW5wdXQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNoYXJpdGllc19faW5wdXRcIik7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICB9XHJcblxyXG4gIF9nZXRDYXVzZSgpIHtcclxuICAgIHZhciBlbGVtZW50cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlOYW1lKFwiY2F1c2VcIik7XHJcbiAgICB2YXIgY2F1c2U7XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGlmIChlbGVtZW50c1tpXS5jaGVja2VkKSB7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coZWxlbWVudHNbaV0pO1xyXG4gICAgICAgIGNhdXNlID0gZWxlbWVudHNbaV0udmFsdWU7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBjYXVzZTtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fZm9ybUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgY29uc3Qgc2VsZWN0ZWRDYXVzZSA9IHRoaXMuX2dldENhdXNlKCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoc2VsZWN0ZWRDYXVzZSk7XHJcbiAgICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vcG9wdXAuanNcIjtcclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRG9uYXRpb25zUG9wdXAgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoZm9ybVN1Ym1pdCwgcG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xyXG4gICAgdGhpcy5fZG9uYXRpb25Gb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZG9uYXRpb24tZm9ybVwiKTtcclxuICAgIHRoaXMuX2Zvcm1TdWJtaXQgPSBmb3JtU3VibWl0O1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcclxuICAgIGNvbnN0IGlucHV0RWxlbWVudHMgPSB0aGlzLl9kb25hdGlvbkZvcm0ucXVlcnlTZWxlY3RvckFsbChcclxuICAgICAgXCIuZG9uYXRpb24tZm9ybV9faW5wdXRcIlxyXG4gICAgKTtcclxuICAgIGlucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGlucHV0VmFsdWVzO1xyXG4gIH1cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX2RvbmF0aW9uRm9ybS5yZXNldCgpO1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICB9XHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9kb25hdGlvbkZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHRoaXMuX2dldElucHV0VmFsdWVzKCk7XHJcbiAgICAgIHRoaXMuX2Zvcm1TdWJtaXQoaW5wdXRWYWx1ZXMpO1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0aW9uIHtcclxuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2Zvcm1TZWxlY3RvciA9IHNldHRpbmdzLmZvcm1TZWxlY3RvcjtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSB7XHJcbiAgICBjb25zdCBfZXJyb3JFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIF9lcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XHJcbiAgICBfZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBfZXJyb3JFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIF9lcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICAgIF9lcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcclxuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfaGFzSW52YWxpZElucHV0KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGRpc2FibGVTdWJtaXRCdXR0b24gPSAoKSA9PiB7XHJcbiAgICBjb25zdCBidXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3JcclxuICAgICk7XHJcbiAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICB9O1xyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKFxyXG4gICAgICB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXHJcbiAgICApO1xyXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yXHJcbiAgICApO1xyXG4gICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIkRvbmF0aW9uQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsImNhcmRUZW1wbGF0ZSIsInRoaXMiLCJfZGF0YSIsIl9jYXJkU2VsZWN0b3IiLCJfZW1haWwiLCJlbWFpbCIsIl9sb2NhdGlvbiIsImxvY2F0aW9uIiwiX2Rlc2MiLCJ0ZXh0IiwiX2xpbmsiLCJsaW5rIiwiX2NhcmRUZW1wbGF0ZSIsIl9nZXRUZW1wbGF0ZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJjcmVhdGVDYXJkIiwiX2NhcmRFbGVtZW50IiwiX2NhcmRFbWFpbCIsIl9jYXJkTG9jYXRpb24iLCJfY2FyZERvbmF0aW9uIiwiX2NhcmRJbWFnZSIsInRleHRDb250ZW50Iiwic3JjIiwiYWx0IiwiU2VjdGlvbiIsInJlbmRlcmVyIiwiZWxlbWVudFNlbGVjdG9yIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiaXRlbXMiLCJmb3JFYWNoIiwiaXRlbSIsImFkZEl0ZW0iLCJuZXdDYXJkIiwicHJlcGVuZCIsImNsZWFySXRlbXMiLCJfY2FyZHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaSIsImxlbmd0aCIsInJlbW92ZSIsIkNoYXJpdHlDYXJkIiwiY2FyZFNlbGVjdG9yIiwiX25hbWUiLCJuYW1lIiwiX3Byb2ZpbGVVcmwiLCJwcm9maWxlVXJsIiwiX2xvZ29VcmwiLCJsb2dvVXJsIiwiZ2VuZXJhdGVDYXJkIiwiX2VsZW1lbnQiLCJocmVmIiwiUG9wdXAiLCJfcmVmIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJfcG9wdXBDbG9zZUJ1dHRvbiIsIl9jbG9zZUJ5RXNjYXBlIiwiZXZ0Iiwia2V5IiwiY2xvc2UiLCJvcGVuIiwiY2xhc3NMaXN0IiwiYWRkIiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImRvbmF0ZUJ1dHRvbiIsImFwaSIsImJhc2VVcmwiLCJhcGlLZXkiLCJfYmFzZVVybCIsIl9hcGlLZXkiLCJfcmVxdWVzdCIsInVybCIsImZldGNoIiwidGhlbiIsInJlbmRlclJlc3VsdCIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJnZXRJbmZvIiwiY2F1c2UiLCJmb3JtRWxlbWVudCIsImhhbmRsZUZvcm1TdWJtaXQiLCJfZm9ybUVsZW1lbnQiLCJfZm9ybSIsIl9mb3JtQnRuIiwiX2lucHV0IiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZ2V0Q2F1c2UiLCJlbGVtZW50cyIsImdldEVsZW1lbnRzQnlOYW1lIiwiY2hlY2tlZCIsInZhbHVlIiwicHJldmVudERlZmF1bHQiLCJzZWxlY3RlZENhdXNlIiwicmVzZXQiLCJjaGFyaXR5Q2FyZExpc3QiLCJub25wcm9maXRzIiwiY2F0Y2giLCJjb25zb2xlIiwiZXJyb3IiLCJkb25hdGlvbnNQb3B1cCIsImZvcm1TdWJtaXQiLCJzdXBlciIsIl9kb25hdGlvbkZvcm0iLCJfZm9ybVN1Ym1pdCIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0VmFsdWVzIiwiaW5wdXQiLCJpbnB1dERhdGEiLCJzZWN0aW9uRG9uYXRpb25zIiwiY2FyZERhdGEiLCJkb25hdGlvbkZvcm1WYWxpZGF0b3IiLCJyZXNldFZhbGlkYXRpb24iLCJkb25hdGlvbkZvcm1FbGVtZW50Iiwic2V0dGluZ3MiLCJfZm9ybVNlbGVjdG9yIiwiZm9ybVNlbGVjdG9yIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwiX2Vycm9yRWxlbWVudCIsImlkIiwiX2hpZGVJbnB1dEVycm9yIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfaW5wdXRMaXN0Iiwic29tZSIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiX2J1dHRvbkVsZW1lbnQiLCJkaXNhYmxlZCIsImRpc2FibGVTdWJtaXRCdXR0b24iLCJidXR0b25FbGVtZW50IiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiQXJyYXkiLCJmcm9tIiwiZW5hYmxlVmFsaWRhdGlvbiJdLCJzb3VyY2VSb290IjoiIn0=